{% extends 'CcmSiaBundle::layout.html.twig' %}

{% block css %}

    {{ parent() }}

    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&language=es"></script>
    <script src="{{ asset('bundles/ccmsia/js/address.js') }}" type="text/javascript"></script>

{% endblock %}


{% form_theme form 'CcmSiaBundle::form_errors.html.twig' %}

{% block wrapper %}

    {{ form_start(form) }}

    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Nueva Solicitud</h1>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-4">
                <div ng-controller="DatepickerDemoCtrl" class="form-group input-group">
                    <div>{{ form_label(form.inicio) }}</div>
                    <div>
                        {{ form_widget(form.inicio, { 'attr': {
                        'class': 'form-control',
                        'datepicker-popup': 'yyyy-MM-dd',
                        'ng-model':'dt',
                        'is-open':'opened',
                        'min-date':'minDate',
                        'max-date':"'2015-06-22'",
                        'datepicker-options':'dateOptions',
                        'ng-required':'false',
                        'close-text':'Close'  }} )  }}
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>
                        <p class="text-danger">
                    </div>
                    {{ form_errors(form.inicio) }}
                </div>
            </div>

            <div class="col-lg-4">
                <div ng-controller="DatepickerDemoCtrl" class="form-group input-group">
                    <div>{{ form_label(form.fin) }}</div>
                    <div>
                        {{ form_widget(form.fin, { 'attr': {
                        'class': 'form-control',
                        'datepicker-popup': 'yyyy-MM-dd',
                        'ng-model':'dt',
                        'is-open':'opened',
                        'min-date':'minDate',
                        'max-date':"'2015-06-22'",
                        'datepicker-options':'dateOptions',
                        'ng-required':'false',
                        'close-text':'Close'  }}) }}
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>

                   </div>
                   <div>{{ form_errors(form.fin) }}</div>
                </div>
            </div>
            <div class="col-lg-4">
                    <h3><span class="label label-primary" id="days"></span></h3>
                {#<p class="text-info" id="days"></p>#}
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-4">
                <div class="form-group">
                    <div>
                        {{ form_label(form.tipo) }}
                    </div>
                    <div>
                        {{ form_widget(form.tipo, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.tipo) }}</div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="form-group">
                    <div>
                        {{ form_label(form.proyecto) }}
                    </div>
                    <div>
                        {{ form_widget(form.proyecto, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.proyecto) }}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-4">
                <div class="form-group">
                    <div>
                        {{ form_label(form.academico) }}
                    </div>
                    <div>
                        {{ form_widget(form.academico, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.academico) }}</div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="form-group">
                    <div>
                        {{ form_label(form.sesion) }}
                    </div>
                    <div>
                        {{ form_widget(form.sesion, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.sesion) }}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="page-header">
        <h1><small>Dirección</small></h1>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-8">
                <div class="form-group">
                    <div id="locationField">
                        <input class="form-control" id="autocomplete" placeholder="Dirección a buscar" onFocus="geolocate()" type="text"></input>
                        <span class="help-block">Escriba una dirección para autocompletar los campos correspondientes.</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-8">
                <div class="form-group">
                    <div>
                        {{ form_label(form.pais) }}
                    </div>
                    <div>
                        {{ form_widget(form.pais, {'id': 'country', 'attr': {'class': 'form-control'}} ) }}
                    </div>
                    <div>{{ form_errors(form.pais) }}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-4">
                <div class="form-group">
                    {#<input class="field" id="locality" disabled="true"></input>#}
                    <div>
                        {{ form_label(form.ciudad) }}
                    </div>
                    <div>
                        {{ form_widget(form.ciudad, {'id': 'locality', 'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.ciudad) }}</div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="form-group">
                    <div>
                        {{ form_label(form.estado) }}
                    </div>
                    <div>
                        {{ form_widget(form.estado, {'id': 'administrative_area_level_1', 'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.estado) }}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-8">
                <div class="form-group">
                    <div>
                        {{ form_label(form.universidad) }}
                    </div>
                    <div>
                        {{ form_widget(form.universidad, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.universidad) }}</div>
                </div>
            </div>

            {%  if form.actividad is defined %}
                <div class="col-lg-8">
                    <div class="form-group">
                        <div>
                            {{ form_label(form.actividad) }}
                        </div>
                        <div>
                            {{ form_widget(form.actividad, {'attr': {'class': 'form-control'} } ) }}
                        </div>
                        <div>{{ form_errors(form.actividad) }}</div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-8">
                <div class="form-group">
                    <div>
                        {{ form_label(form.profesor) }}
                    </div>
                    <div>
                        {{ form_widget(form.profesor, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.profesor) }}</div>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="form-group">
                    <div>
                        {{ form_label(form.proposito) }}
                    </div>
                    <div>
                        {{ form_widget(form.proposito, {'attr': {'class': 'form-control'} } ) }}
                    </div>
                    <div>{{ form_errors(form.proposito) }}</div>
                </div>
            </div>
        </div>
    </div>

    {% if form.trabajo is defined %}
        <div class="row">
            <div class="col-lg-8">
                <div class="col-lg-8">
                    <div class="form-group">
                        <div>
                            {{ form_label(form.trabajo) }}
                        </div>
                        <div>
                            {{ form_widget(form.trabajo, {'attr': {'class': 'form-control'} } ) }}
                        </div>
                        <div>{{ form_errors(form.trabajo) }}</div>
                    </div>
                </div>

            </div>
        </div>
    {% endif %}

    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-12">
                <div class="form-group">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                            <tr>
                                <th class="text-center">Fuente de financiamiento</th>
                                <th class="text-center">CCM</th>
                                <th class="text-center">PAPIIT</th>
                                <th class="text-center">Conacyt</th>
                                <th class="text-center">Otro</th>
                            </tr>
                            </thead>
                            <tbody>

                            {% for fin in form.financiamiento %}

                                <tr>
                                    <td>{{ form_widget(fin.nombre, { 'attr':{'class': 'form-control','readonly':'true'} }) }}</td>
                                    <td>{{ form_widget(fin.ccm, { 'attr':{'class': 'form-control'} }) }}  {{ form_errors(fin.ccm) }}</td>
                                    <td>{{ form_widget(fin.papiit, { 'attr':{'class': 'form-control'} }) }} {{ form_errors(fin.papiit) }}</td>
                                    <td>{{ form_widget(fin.conacyt, { 'attr':{'class': 'form-control'} }) }} {{ form_errors(fin.conacyt) }}</td>
                                    <td>{{ form_widget(fin.otro, { 'attr':{'class': 'form-control'} }) }} {{ form_errors(fin.otro) }}</td>
                                </tr>
                            {% endfor %}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-lg-8">
            <div class="col-lg-12">
                {{ form_widget(form.save,{'attr':{'class':'btn btn-primary'} } )}}
                {{ form_widget(form.saveAndAdd,{'attr':{'class':'btn btn-success',
                'onclick':"return confirm('¿Estás seguro de enviar la solicitud?,
                        después de esta acción la solicitud no podrá ser modificada')"} } )}}
                <a href="{{ path('solicitud') }}" type="button"  class="btn btn-danger">Cancelar</a>
            </div>
        </div>
    </div>

    {{ form_rest(form) }}
    {{ form_end(form) }}

    <br>
    <div>
        {% if is_granted('ROLE_PREVIOUS_ADMIN') %}
            <ul>
                <li>
                    <a href="{{ path('solicitud', {'_switch_user': '_exit'}) }}">Exit impersonation</a>
                </li>
            </ul>
        {% endif %}
    </div>


{% endblock %}

